# 第二章 室内定位方法理论
## WLAN 室内定位技术
WLAN 有两种工作模式，基础架构模式（集中控制模式）是一种最为重要的工作模式，它是利用WLAN接入点（Access Point， 简称AP）来承担通信和无线网络覆盖的任务。接入点有些类似无线蜂窝网里的基站，将多个无线的移动终端聚合到有线的网络上。另外一种使用的比较少的工作模式为点对点模式，这种工作方法将需要互相通讯的一组无线网卡的标识设为同一个值来构成一宗特殊的无线网络应用模式，这种模式不利于实现网络互联和资源互享。基础架构模式具有比较好的网络容量和覆盖量，通信的可靠性相对来说比较高，因此该模式应用的最为广泛。图片2-1为工作在基础架构模式下的 WLAN 的结构图。［图片2-1］。
在基础架构工作的模式下，接入点以一定的频率向外连续发射无线信号，标识接入点的存在和发布有关无线网络的基本信息，比如 SSID（服务集标识）、RSS 信号强度信息等。WLAN 客户端通过接收无线信号的相关信息，然后按照一定的方法，选择某个合适的接入点建立无线连接。比如选择与信号强度最强的接入点来进行连接，或者直接选择与某个指定的接入点。本文研究的基于 WLAN 位置指纹室内定位系统正是利用 WLAN 客户端与接入点之间的无线信号信息进行位置估计。

### 基本定位方法
目前，室内定位技术的基本定位方法有几何法（Geometry）、近似法（Proximity）、场景分析法（Scene Analysis）。下面会对这几种方法进行一个简单的介绍分析。

#### 几何法
几何法是根据几何学原理去估计待定位目标的位置。又可以细分为距离测量法和角度测量法。

##### 距离测量法
  距离测量法通过测量待定位置目标与其他多个位置已知的参考点之间的距离来计算待定位目标的位置。一般来说，在二维平面上，已知一个点与其他三个不共线的参考点的之间的距离就可以计算出该点与其他三个参考点之间的相对位置。同理，将这一概念映射到 WLAN 室内定位中，可以将 WLAN 的接入点作为参考点，来计算待定位目标与接入点距离，然后进一步就可以计算出待定位目标的位置。通过测量无线信号的到达时间（Time of Arrival，简称 TOA）是一种很经典的距离测量的方法。
#### 角度测量法
角度测量法也称之为到达角度法（Angle of Arrival, 简称 AOA），利用两个位置已知的参考点法设信号到达待定位目标的角度来计算出待定位目标的位置。

#### 近似法
近似法是利用位置已知的某个参考点的位置来估计待定位目标的位置。在 WLAN 中，接入点可以被视为是已知的参考点。而且每个参考点都有一定的信号覆盖范围。当待定位目标进入到该接入点的信号覆盖范围之后，就可以使用该接入点的位置粗略的来表示待定位目标的位置。

#### 场景分析法
场景分析法是利用场景中不同参考点的特征的唯一性来计算出待定位目标的位置。基于 WLAN 位置指纹的定位方法就是一种很经典的场景分析法。基于 WLAN 位置指纹的定位方法就是利用用户所处位置测量到的位置指纹，去跟位置指纹数据库中的位置指纹利用特定的匹配规则来计算待定位目标所处的位置。其中 RSS 很适合作为位置指纹，因为 RSS 易于测量，而且不需要额外的软件或者硬件的支持。微软的经典定位系统 RADAR 就是使用 RSS 数据作为指纹数据。


## 基于 WLAN 位置指纹定位技术

### 基本原理
WLAN 定位的基本原理是利用无线信号（主要是RSS）或者其他环境特征在不同位置上的空间差异性，将真实空间中的位置映射成位置指纹数据，就是将物理位置与 RSS 信号关联起来。然后建立指纹数据库，从而通过指纹匹配的方式实现对用户位置的估计。基于 WLAN 位置指纹定位方法包括两个阶段：一个是离线训练阶段，一个是在线定位阶段。离线阶段需要有专人对定位区域进行指纹采集，在每一个采样点上收集无线信号特征，然后将这些采集到的无线信号特征转换成指纹数据存入指纹数据库。在线定位阶段，用户通过移动终端收集所在位置的无线信号值，然后将这些数据转化成指纹数据并发送到定位服务器，服务器将该查询指纹与数据库进行匹配，将最相似的指纹对应的位置作为用户的位置发送给用户，定位也就完成了。
［图片2-2］

### RSS 位置指纹数据库
指纹库就记录了位置指纹与实际物理位置的映射。根据不同算法对指纹数据的要求不同，大致可以将基于 WLAN 位置指纹定位方法分为确定性方法和概率性方法两大类。确定性的方法是将指纹数据进行均值处理然后存入数据库中，然后根据确定性的算法来计算出用户的位置（可以将均值的方法详细说明）。第二种基于概率的方法不同于确定性的方法里用信号强度的平均值表示位置指纹，基于概率的方法是通过条件概率加上无线信号信息作为位置指纹建立指纹模型并采用概率匹配方法来估计用户的位置。

## 主要定位算法
定位技术实现的最后一步就是定位算法的选择，本节将介绍两种经典的定位算法，最近邻法和朴素贝叶斯算法，它们分别代表了确定性定位方法和概率性定位方法。

### 最近邻法
k 最近邻（k-Nearest Neighbor, 简称KNN）分类算法，是一个比较成熟的分类算法，也是最基础的机器学习算法之一。该方法的原理是如果一个样本在特征空间中的 k 个最相似（即特征空间中最邻近）的样本中的大多数样本属于某一个类别，则该样本也属于这个类别。最近邻法可以看成是 k 最近邻分类法的一个特殊情况，即 k ＝ 1的情况。

### 朴素贝叶斯算法


## 本章小结
本章内容对基于 WLAN 的室内定位技术进行了一个简单的介绍。首先，介绍了 WLAN 的两种工作模式，以及主要使用的模式和优点。然后着重介绍了室内定位的几种基本的定位方法（几何法、近似法、场景分析法），并较全面的归纳了基于这些思想的经典的定位方法。随后，详细分析了基于 WLAN 位置指纹定位技术的优势所在，适应性强，成本低，适用范围广等。也确定了基于 WLAN 位置指纹定位技术将作为本文的研究重点。并且详细介绍了该技术相关的背景、研究现状及基本原理。最后，介绍两种经典的定位算法，后面的研究也是围绕这两种算法开展。
